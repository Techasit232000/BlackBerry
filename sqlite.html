<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BlackBerry Dynamics: Secure SQL Database programming interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen_13.1.0.48.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra_13.1.0.48.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
	<div id="titleheadings">
	<ul> 
		<li id="projectlogo">
	 		<a id="corplink" href="https://blackberry.com/"><img alt="Logo" src="BlackBerryLogo.png"/></a></li>
	 	<li id="projectname">BlackBerry Dynamics</li>
	  	<li id="projectbrief">Runtime library for iOS applications</li>
	  	<li id="projectnumber">13.1.0.48</li>
	 </ul>
	</div>
	 <div id="titlelinks">
	 		<a href="https://developers.blackberry.com">BlackBerry Developers</a>
	 </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('sqlite.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Secure SQL Database programming interface </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The secure SQL database is part of the BlackBerry Dynamics secure storage feature.</p>
<p>Data stored in the secure SQL database will be encrypted on the device by the BlackBerry Dynamics runtime.</p>
<p>The BlackBerry Dynamics secure SQL database is based on the SQLite library. Encryption is added by BlackBerry Dynamics, transparently to the application.</p>
<p>The secure SQL database cannot be accessed until BlackBerry Dynamics authorization processing is complete.</p>
<p>As well as the secure SQL database, the BlackBerry Dynamics secure store also includes a secure file system, and a secure store for Core Data. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="interface_g_di_o_s.html">GDiOS</a>, for BlackBerry Dynamics authorization </dd>
<dd>
<a class="el" href="interface_g_d_file_manager.html">GDFileManager</a> </dd>
<dd>
<a class="el" href="interface_g_d_persistent_store_coordinator.html">GDPersistentStoreCoordinator</a>, for the Secure Storage API for Core Data </dd>
<dd>
<a href="http://www.sqlite.org/" target="_blank">http://www.sqlite.org/</a>, the home page of the SQLite project.</dd></dl>
<h3>Overview of the programming interface</h3>
<p>BlackBerry Dynamics applications can access the secure database using the normal SQLite programming interface with a number of additional functions, see below. </p><dl class="section see"><dt>See also</dt><dd><a href="http://www.sqlite.org/c3ref/intro.html" target="_blank">http://www.sqlite.org/c3ref/intro.html</a>, for the reference documentation of the normal SQLite programming interface.</dd></dl>
<h3>Additional Functions</h3>
<p>Include the <code><a class="el" href="sqlite3enc_8h.html">sqlite3enc.h</a></code> file in order to use these functions.</p>
<p><code><b>int sqlite3enc_open(const char *filename, sqlite3 **ppDb);</b></code><br  />
Use this function to open an encrypted database, in the secure store.</p>
<p>This function can only be called after BlackBerry Dynamics authorization processing is complete, see under <a class="el" href="interface_g_di_o_s.html">GDiOS</a>.</p>
<p>The parameters are the same as the <code>sqlite3_open</code> function in the normal SQLite programming interface, see link above.</p>
<p><code><b>int sqlite3enc_import(const char *srcFilename, const char *destFilename);</b></code><br  />
Use this function to create an encrypted database from a plain SQLite database file. The database file must be in the secure file system, see <a class="el" href="interface_g_d_file_manager.html">GDFileManager</a>.</p>
<p>After a succesful import, the database can be opened using <code>sqlite3enc_open</code>, see above.</p>
<p>This function would typically be used on an SQLite database that had been retrieved as a single file from an application server.</p>
<p>This function will not create intermediate sub-directories in the destination path. Intermediate directories must exist prior to calling the function.</p>
<p>This function can only be called after BlackBerry Dynamics authorization processing is complete, see under <a class="el" href="interface_g_di_o_s.html">GDiOS</a>.</p>
<dl>
<dt>Parameters:</dt>
<dd><em>srcFilename</em> path, within the secure file system, of the plain SQLite database file to be imported.<br  />
<em>destFilename</em> database to be created. If the database already exists, its contents will be overwritten.</dd>
<dt>Returns:</dt>
<dd>On success, <code>SQLITE_OK</code> is returned.<br  />
Otherwise an SQLite error code is returned.</dd>
</dl>
<h2>Code Snippets</h2>
<p>The following code snippets illustrate some common tasks. </p><h3>Open database</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#import &lt;GD/sqlite3enc.h&gt;</span></div>
<div class="line"> </div>
<div class="line">sqlite3 *pDb = NULL;</div>
<div class="line"><span class="keywordtype">char</span> *errorMsg = NULL;</div>
<div class="line"><span class="keywordtype">int</span> returnCode;</div>
<div class="line"><span class="keywordtype">char</span> *databaseName = NULL;</div>
<div class="line"> </div>
<div class="line">databaseName = <span class="stringliteral">&quot;financials.db&quot;</span>;</div>
<div class="line">returnCode = <a class="code" href="sqlite3enc_8h.html#ad3d0721d9129f4fb8c88fb9ec7d6903f">sqlite3enc_open</a>(databaseName, &amp;pDb);</div>
<div class="line"><span class="keywordflow">if</span>(returnCode!=SQLITE_OK) {</div>
<div class="line">    fprintf(stderr,</div>
<div class="line">        <span class="stringliteral">&quot;Error in opening the database. Error: %s&quot;</span>, sqlite3_errmsg(pDb)</div>
<div class="line">    );</div>
<div class="line">    sqlite3_close(pDb);</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h3>Delete table</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#import &lt;GD/sqlite3enc.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *sqlStatement = NULL;</div>
<div class="line"> </div>
<div class="line">sqlStatement =  <span class="stringliteral">&quot;DROP TABLE IF EXISTS  stocks&quot;</span>;</div>
<div class="line"><span class="keywordflow">if</span>(returnCode!=SQLITE_OK) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Error in dropping table stocks. Error: %s&quot;</span>, errorMsg);</div>
<div class="line">returnCode = sqlite3_exec(pDb, sqlStatement, NULL, NULL, &amp;errorMsg);</div>
<div class="line">    sqlite3_free(errorMsg);</div>
<div class="line">}</div>
</div><!-- fragment --><h3>Create table</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#import &lt;GD/sqlite3enc.h&gt;</span></div>
<div class="line"> </div>
<div class="line">sqlStatement =</div>
<div class="line">    <span class="stringliteral">&quot;CREATE TABLE stocks (symbol VARCHAR(5), &quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;purchasePrice FLOAT(10,4), unitsPurchased INTEGER, &quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;purchase_date VARCHAR(10))&quot;</span>;</div>
<div class="line">returnCode = sqlite3_exec(pDb, sqlStatement, NULL, NULL, &amp;errorMsg);</div>
<div class="line"><span class="keywordflow">if</span>(returnCode!=SQLITE_OK) {</div>
<div class="line">    fprintf(stderr,</div>
<div class="line">        <span class="stringliteral">&quot;Error in creating the stocks table. Error: %s&quot;</span>, errorMsg</div>
<div class="line">    );</div>
<div class="line">    sqlite3_free(errorMsg);</div>
<div class="line">}</div>
<div class="line">sqlite3_close(pDb);</div>
</div><!-- fragment --><h3>Read data</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#import &lt;GD/sqlite3enc.h&gt;</span></div>
<div class="line"> </div>
<div class="line">sqlStatement = sqlite3_mprintf(</div>
<div class="line">    <span class="stringliteral">&quot;SELECT S.symbol, S.unitsPurchased, S.purchasePrice &quot;</span></div>
<div class="line">    <span class="stringliteral">&quot;FROM stocks AS S WHERE S.purchasePrice  &gt;= %f&quot;</span>, 30.0</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line">returnCode = sqlite3_prepare_v2(</div>
<div class="line">    <a class="code" href="_g_d_s_q_l_database_8h.html#a9e760fc1757ca0c8d34c1f113c527415">database</a>, sqlStatement, strlen(sqlStatement), &amp;statement, NULL</div>
<div class="line">);</div>
<div class="line"><span class="keywordflow">if</span>(returnCode!=SQLITE_OK) {</div>
<div class="line">    printf(</div>
<div class="line">        <span class="stringliteral">&quot;Error in preparation of query. Error: %s&quot;</span>, sqlite3_errmsg(<a class="code" href="_g_d_s_q_l_database_8h.html#a9e760fc1757ca0c8d34c1f113c527415">database</a>)</div>
<div class="line">    );</div>
<div class="line">    sqlite3_close(<a class="code" href="_g_d_s_q_l_database_8h.html#a9e760fc1757ca0c8d34c1f113c527415">database</a>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line">returnCode = sqlite3_step(statement);</div>
<div class="line"><span class="keywordflow">while</span>(returnCode == SQLITE_ROW){</div>
<div class="line">     <span class="keywordtype">char</span> *symbol;</div>
<div class="line">     <span class="keywordtype">int</span>  units;</div>
<div class="line">     <span class="keywordtype">double</span> price;</div>
<div class="line">     symbol = (<span class="keywordtype">char</span>*)sqlite3_column_text(statement, 0);</div>
<div class="line">     units  = sqlite3_column_int(statement, 1);</div>
<div class="line">     price  = sqlite3_column_double(statement, 2);</div>
<div class="line">     printf(</div>
<div class="line">         <span class="stringliteral">&quot;We bought %d from %s at a price equal to %.4f\n&quot;</span>,</div>
<div class="line">         units, symbol, price</div>
<div class="line">     );</div>
<div class="line">     returnCode = sqlite3_step(statement);</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="asqlite3enc_8h_html_ad3d0721d9129f4fb8c88fb9ec7d6903f"><div class="ttname"><a href="sqlite3enc_8h.html#ad3d0721d9129f4fb8c88fb9ec7d6903f">sqlite3enc_open</a></div><div class="ttdeci">SQLITE_API int sqlite3enc_open(const char *filename, sqlite3 **ppDb)</div></div>
<div class="ttc" id="a_g_d_s_q_l_database_8h_html_a9e760fc1757ca0c8d34c1f113c527415"><div class="ttname"><a href="_g_d_s_q_l_database_8h.html#a9e760fc1757ca0c8d34c1f113c527415">database</a></div><div class="ttdeci">package com good gd database</div><div class="ttdef"><b>Definition:</b> GDSQLDatabase.h:7</div></div>
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="aapi.html">Additional Programming Interfaces</a></li>
    <li class="footer">
Generated Wed Mar 12 2025 12:06:26
with v1.8.17 <a href="http://www.doxygen.org/index.html" target="_blank">doxygen</a >.
Version 13.1.0.48.
© 2025 BlackBerry Limited. All rights reserved.
    </li>
  </ul>
</div>
</body>
</html>
